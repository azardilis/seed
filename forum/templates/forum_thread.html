<html>
     <head>
	<script src="js/jq-1.8.3.js"></script>
	<script src="js/functions.js"></script>
	<link type="text/css" rel="stylesheet" href="/stylesheets/main.css" />
	<script type="text/javascript">
		$(document).ready(function(){
			$('p.reply').click(function(){
				var e = $(this);
				var pid = e.attr('pid');
				$('#rf'+pid).slideDown();
			});
			
			$('p.quote').click(function(){
				var e = $(this);
				var pid = e.attr('pid');
				var poster = $('article.art#'+pid).attr('poster');
				var qs = "[quote="+poster+"]"+$('article.art#'+pid).html()+"[/quote]";
				$('#rf'+pid+' textarea').html(qs);
				$('#rf'+pid).slideDown();
			});
			
		$('form.psreplyform').submit(function(event)
		{
			var $form = $(this),
			$inputs = $form.find("input, button,textarea"),
			serializedData = $form.serialize();
			alert('clicked1');
			
			$inputs.attr("disabled", "disabled");
			$.ajax(
			{
				url: "/replypost",
				type: "POST",
				data: serializedData,
				contentType: 'application/x-www-form-urlencoded',
				dataType: 'html',
				success: function(data, textStatus)
				{
					alert('refresh');
				},
				error: function(xmlhttp, textStatus, errorThrown)
				{
					alert('There was an error while creating a new thread.');
				},
				complete: function()
				{
					$inputs.removeAttr("disabled");
				}
			});
			event.preventDefault();
		});
		
			
		});
        </script>


<style type="text/css">
	
	.post {
		border : 1px solid blue;	
		padding :  2%;
		margin : 1%;
	}
	
	#thread{
		border : 1px solid green ;
		padding : 10px ;
		margin : 5px ;
	}
	
	
	#replyform{
		padding :  2%;
		margin : 1%;
	}
	
	#replyform *{
		display : block ;
	}
	
	span.controls *{
		display : inline;
		color : #005566;
		font-size : 9pt;
		
	}
	
	span.controls p:hover{
		cursor : pointer ;
		text-decoration : underline;
	}
	
	form.psreplyform{
		display : none ;
	}
	
	form.psreplyform *{
		display : block 
	}

</style>           
    
  </head>
 <body>
  
 <section id="content" class="content"> 
   

	<!-- This includes the sidebar-->
	{% include "/templates/sidebar.html"%}

	<section id="pagecontent" class="cleared">
		<article id='thread'>
		<h1>{{ thread.subject }}</h1>
		<p>{{ thread.body }}</p>
		</article>
		<section id="reply">
			<form method="POST" action="/replythread" id="replyform">
				<input type="hidden" name="tid" value="{{thread.key().id()}}">
				<input type="hidden" name="sbj" value="RE:{{thread.subject}}">
				<textarea name="bd" cols="70" rows="8"></textarea>
				<input type="submit" value="Reply!">
			</form>
		</section>
		
		<section id='responses'>
			{{posts}}		
		</section>
	</section>
	
	<section class="cleared">	</section>
</section>
</body>
</html>
