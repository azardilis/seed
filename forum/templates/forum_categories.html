<html>
<head>
	<link type="text/css" rel="stylesheet" href="/stylesheets/main.css" />
	<link type="text/css" rel="stylesheet" href="/stylesheets/forum_categories.css" />
	<script src="js/jq-1.8.3.js"></script>
	<script src="js/jqui-1.9.2.js"></script>
	<script type="text/javascript" src="js/forum_categories.js"></script>
</head>
<body>
	
	<section id="content" class="content"> 
		

		<!-- This includes the sidebar-->
		{% include "/templates/sidebar.html"%}

		<section id="pagecontent" class="cleared">
			
			<section id="module_info">
				<h3>{{module.key().name() + ' - ' + module.title}}</h3>
				<section id="module_stats">

					<!-- TODO: more complete description when hover over-->
					<div class="value">{{subscribed}}</div>
					<div class="descr">Students Registered</div>
	
					<div class="value">5/10</div>
					<div class="descr">Average Difficulity</div>
				</section>
				<section id="lecturer_ratings">
					{% for rating in ratings %}
					<dl class="lecturer">
						<dt><a href={{rating.lecturer.home_page}}>{{rating.lecturer.full_name}}</a></dt>
						<dd>Rating: {{rating.totalSum/rating.totalVotes if totalVotes}}</dd>
					</dl>
					{% endfor %}
				</section>
				<section id="assessment_stats">
					{% for assessment in assessments: %}
                                        {% if assessment.count_marks != 0: %}
					<a href={{assessment.specLink}}>{{assessment.title}}</a> Average mark: {{assessment.sum_marks/assessment.count_marks}}
                                        {% endif %}
                                        {% endfor %}
				</section>
						
			</section>

			<section id="categories">
				<section class="category">			
					{% for c in complete %}				
					<section class="container">
						<p class="handler"  id="{{c[0].key().id()}}">{{  c[0].name }}</p>
						<a href="/threads?cid={{ c[0].key().id()}}" class="more">Show more...</a>
					</section>
					<section class="handlercontent" id="cont{{c[0].key().id()}}">
						{% for th in c[1] %}
						<!-- after adding all the functionality, make this pretty and display all stats (like ratings and so on) -->
						<article class="thread">
							<a href="/showthread?tid={{ th.key().id() }}" class="thtitle">
								<b>{{th.subject}}</b>
							</a>
							<p class="details">Posted by {{th.poster.key().name()}} on {{th.timestamp.date()}}</p>							
							<p class="thbody">{{th.body[0:50]}}...</p>
							<p class="rating">Rating : {{th.votes}}</p>
						</article>
						{% endfor %}
					</section>
					{% endfor %}
				</section>
			</section>
		</section>
	</section>
</body>
</html>
