<html>
<head>
	<link type="text/css" rel="stylesheet" href="/stylesheets/main.css" />
	<link type="text/css" rel="stylesheet" href="/stylesheets/forum_categories.css" />
	<script src="js/jq-1.8.3.js"></script>
	<script src="js/jqui-1.9.2.js"></script>
	<script type="text/javascript" src="js/forum_categories.js"></script>
</head>
<body>
	
	<section id="content" class="content"> 
		

		<!-- This includes the sidebar-->
		{% include "/templates/sidebar.html"%}

		<section id="pagecontent" class="cleared">
			
			<section id="module_info">
				<h3>{{module.key().name() + ' - ' + module.title}}</h3>
				<section id="module_stats">

					<!-- TODO: more complete description when hover over-->
					<div class="value">{{subscribed}}</div>
					<div class="descr">Students Registered</div>
					{% if module.count_marks %}
					<div class="value">{{module.sum_marks/module.count_marks}}</div>
					<div class="descr">Average Mark</div>
					{% endif %}
					{% if module.count_marks %}
					<div class="value">{{module.sum_difficulty/module.count_difficulty}}/5</div>
					<div class="descr">Overall Difficulity</div>
					{% endif %}
					{% if module.count_marks %}
					<div class="value">{{module.sum_interest/module.count_interest}}</div>
					<div class="descr">Interest Score</div>
					{% endif %}
				</section>
				<section id="lecturer_ratings">
					{% for rating in ratings %}
					<dl class="lecturer">
						<dt><a href={{rating.lecturer.home_page}}>{{rating.lecturer.full_name}}</a></dt>
						{% if rating.totalVotes : %}
						<dd>Rating: {{rating.totalSum/rating.totalVotes}}</dd>
						{% endif %}
					</dl>
					{% endfor %}
				</section>

				<section id="lecturer_ratings">
					<dl class="lecturer">
					{% for assessment in assessments: %}
                                        {% if assessment.count_marks != 0: %}
						<dt><a href={{assessment.specLink}}>{{assessment.title}}</a></dt>
						{% if assessment.count_marks: %}
						<dd>Avg. Mark: {{assessment.sum_marks/assessment.count_marks}}
						{% endif %}
						{% if assessment.count_difficulty: %}
						<dd>Difficulty: {{assessment.sum_difficulty/assessment.count_difficulty}}
						{% endif %}
						{% if assessment.count_interest: %}
						<dd>Interest Score: {{assessment.sum_interest/assessment.count_interest}}
						{% endif %}
                                        {% endif %}
                                        {% endfor %}
				</section>
						
<!--
				<section id=asdf>
				<div>
    <div class="histogram-table goog-inline-block" data-csstoken="user-reviews">
      <table>
        <tbody>
          <tr>
            <td class="histogram-msg top-row">5 star</td>

            <td class="top-row bar-cell"><span class="bar bar5" style=
            "width:50px">&nbsp;</span>&nbsp;<span>60</span></td>
          </tr>

          <tr>
            <td class="middle-row histogram-msg">4 star</td>

            <td class="middle-row bar-cell"><span class="bar bar4" style=
            "width:24px">&nbsp;</span>&nbsp;<span>29</span></td>
          </tr>

          <tr>
            <td class="middle-row histogram-msg">3 star</td>

            <td class="middle-row bar-cell"><span class="bar bar3" style=
            "width:11px">&nbsp;</span>&nbsp;<span>13</span></td>
          </tr>

          <tr>
            <td class="middle-row histogram-msg">2 star</td>

            <td class="middle-row bar-cell"><span class="bar bar2" style=
            "width:14px">&nbsp;</span>&nbsp;<span>17</span></td>
          </tr>

          <tr>
            <td class="bottom-row histogram-msg">1 star</td>

            <td class="bottom-row bar-cell"><span class="bar bar1" style=
            "width:4px">&nbsp;</span>&nbsp;<span>5</span></td>
          </tr>
          </tbody>
      </table>
    </div>

    <div class="average-rating average-rating-panel goog-inline-block">
      <div class="average-rating-title">
        Average rating
      </div>

      <div class="average-rating-value">
        4.1
      </div>

      <div class="average-rating-stars">
        <div class="ratings goog-inline-block" title="Rating: 4.1 stars (Above average)">
          <div class="goog-inline-block star SPRITE_star_on_dark"></div>

          <div class="goog-inline-block star SPRITE_star_on_dark"></div>

          <div class="goog-inline-block star SPRITE_star_on_dark"></div>

          <div class="goog-inline-block star SPRITE_star_on_dark"></div>

          <div class="goog-inline-block star SPRITE_star_off_dark"></div>
        </div>
      </div>

      <div class="votes">
        271
      </div>
    </div>
  </div>
				</section>
-->
				
			</section>

			<section id="categories">
				<section class="category">			
					{% for c in complete %}				
					<section class="container">
						<p class="handler"  id="{{c[0].key().id()}}">{{  c[0].name }}</p>
						<a href="/threads?cid={{ c[0].key().id()}}" class="more">Show more...</a>
					</section>
					<section class="handlercontent" id="cont{{c[0].key().id()}}">
						{% for th in c[1] %}
						<!-- after adding all the functionality, make this pretty and display all stats (like ratings and so on) -->
						<article class="thread">
							<a href="/showthread?tid={{ th.key().id() }}" class="thtitle">
								<b>{{th.subject}}</b>
							</a>
							<p class="details">Posted by {{th.poster.key().name()}} on {{th.timestamp.date()}}</p>							
							<p class="thbody">{{th.body[0:50]}}...</p>
							<p class="rating">Rating : {{th.votes}}</p>
						</article>
						{% endfor %}
					</section>
					{% endfor %}
				</section>
			</section>
		</section>
	</section>
</body>
</html>
